(()=>{var t,e={523:(t,e,n)=>{Nova.booting((function(t){t.component("commenter",n(957))}))},34:()=>{},957:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});function o(t,e,n,o,r,s,a,i){var c,m="function"==typeof t?t.options:t;if(e&&(m.render=e,m.staticRenderFns=n,m._compiled=!0),o&&(m.functional=!0),s&&(m._scopeId="data-v-"+s),a?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},m._ssrRegister=c):r&&(c=i?function(){r.call(this,(m.functional?this.parent:this).$root.$options.shadowRoot)}:r),c)if(m.functional){m._injectStyles=c;var u=m.render;m.render=function(t,e){return c.call(e),u(t,e)}}else{var l=m.beforeCreate;m.beforeCreate=l?[].concat(l,c):[c]}return{exports:t,options:m}}var r=o({props:{comment:{type:Object,required:!0}},computed:{commentString:function(){return _.find(this.comment.fields,{attribute:"comment"}).value},commenter:function(){return _.find(this.comment.fields,{attribute:"commenter"}).value},commenterUrl:function(){var t=_.find(this.comment.fields,{attribute:"commenter"}).belongsToId;return"/nova/resources/users/".concat(t)},date:function(){var t=moment(),e=moment.utc(_.find(this.comment.fields,{attribute:"created_at"}).value).tz(moment.tz.guess());return e.isSame(t,"minute")?"just now":e.isSame(t,"day")?"at ".concat(e.format("LT")):e.isSame(t,"year")?"on ".concat(e.format("MMM D")):"on ".concat(e.format("ll"))},hasCommenter:function(){return Boolean(this.commenter)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"commenter__comment py-4 border-t border-40"},[n("div",{staticClass:"font-light text-80 text-sm"},[t.hasCommenter?[n("a",{staticClass:"no-underline dim text-primary font-bold",attrs:{href:t.commenterUrl},domProps:{textContent:t._s(t.commenter)}}),t._v("\n\n            said\n        ")]:[t._v("\n            Written\n        ")],t._v("\n\n        "+t._s(t.date)+"\n    ")],2),t._v(" "),n("div",{staticClass:"mt-2",domProps:{innerHTML:t._s(t.commentString)}})])}),[],!1,null,null,null);const s=o({props:["resourceName","resourceId","field"],components:{Comment:r.exports},data:function(){return{baseCommentUri:"/nova-api/comments",comment:"",data:{next_page_url:"",prev_page_url:"",resources:{}}}},mounted:function(){this.getComments(this.commentsUri)},computed:{commentsUri:function(){return"".concat(this.baseCommentUri,"?page=1")},hasComments:function(){return Boolean(this.data.resources.length)},hasNextLink:function(){return Boolean(this.data.next_page_url)},hasPrevLink:function(){return Boolean(this.data.prev_page_url)},hasPagination:function(){return this.hasNextLink||this.hasPrevLink},queryParams:function(){return"&orderBy=created_at&orderByDirection=desc&viaResource=".concat(this.resourceName,"&viaResourceId=").concat(this.resourceId,"&viaRelationship=comments&relationshipType=hasMany")}},methods:{createComment:function(){var t=this;if(!this.comment)return!1;var e={comment:this.comment,viaResource:this.resourceName,viaResourceId:this.resourceId,viaRelationship:"comments"};axios.post(this.baseCommentUri,e).then((function(){t.getComments(t.commentsUri),t.resetComment(),t.$toasted.show("A new comment has been created.",{type:"success"})})).catch((function(e){return t.$toasted.show(e,{type:"error"})}))},getComments:function(t){var e=this;axios.get("".concat(t).concat(this.queryParams)).then((function(t){var n=t.data;return e.data=n}))},paginationClass:function(t){return t?"text-primary dim":"text-80 opacity-50"},resetComment:function(){this.comment=""}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",{staticClass:"text-90 font-normal text-2xl mb-3"},[t._v("\n        Comments\n    ")]),t._v(" "),n("div",{staticClass:"card mb-6 overflow-hidden"},[n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full pt-6 pb-2"},[n("h4",{staticClass:"font-normal text-80"},[t._v("\n                    Write new comment\n                ")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"w-full form-control form-input form-input-bordered py-3 h-auto mt-2",attrs:{id:"commenter",dusk:"commenter",rows:"5"},domProps:{value:t.comment},on:{keyup:function(e){return!e.type.indexOf("key")&&93!==e.keyCode&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.createComment.apply(null,arguments)},input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"flex justify-between px-8 pb-4 border-b border-40"},[n("div",{staticClass:"help-text"},[t._v("\n                On MacOS, press âŒ˜ + Enter to save\n            ")]),t._v(" "),n("button",{staticClass:"btn btn-default btn-primary inline-flex items-center relative mt-4",attrs:{type:"submit"},on:{click:t.createComment}},[t._v("\n                Save Comment\n            ")])]),t._v(" "),t.hasComments?n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full py-6"},[n("h3",{staticClass:"text-90 font-bold text-lg mb-4"},[t._v("Comments")]),t._v(" "),t._l(t.data.resources,(function(t,e){return n("comment",{key:e,attrs:{comment:t}})}))],2)]):t._e(),t._v(" "),t.hasPagination?n("div",{staticClass:"bg-20 rounded-b"},[n("nav",{staticClass:"flex justify-between items-center"},[n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasNextLink),attrs:{disabled:!t.hasNextLink},on:{click:function(e){return t.getComments(t.data.next_page_url)}}},[t._v("\n                    Older\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasPrevLink),attrs:{disabled:!t.hasPrevLink},on:{click:function(e){return t.getComments(t.data.prev_page_url)}}},[t._v("\n                    Newer\n                ")])])]):t._e()])])}),[],!1,null,null,null).exports}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var s=n[t]={exports:{}};return e[t](s,s.exports,o),s.exports}o.m=e,t=[],o.O=(e,n,r,s)=>{if(!n){var a=1/0;for(u=0;u<t.length;u++){for(var[n,r,s]=t[u],i=!0,c=0;c<n.length;c++)(!1&s||a>=s)&&Object.keys(o.O).every((t=>o.O[t](n[c])))?n.splice(c--,1):(i=!1,s<a&&(a=s));if(i){t.splice(u--,1);var m=r();void 0!==m&&(e=m)}}return e}s=s||0;for(var u=t.length;u>0&&t[u-1][2]>s;u--)t[u]=t[u-1];t[u]=[n,r,s]},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={103:0,990:0};o.O.j=e=>0===t[e];var e=(e,n)=>{var r,s,[a,i,c]=n,m=0;if(a.some((e=>0!==t[e]))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(c)var u=c(o)}for(e&&e(n);m<a.length;m++)s=a[m],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(u)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),o.O(void 0,[990],(()=>o(523)));var r=o.O(void 0,[990],(()=>o(34)));r=o.O(r)})();